<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz DWWM Interactif</title>
  <style>
    :root { 
      --color-bg-start: #667eea; 
      --color-bg-end: #764ba2; 
      --color-primary: #74b9ff; 
      --color-success: #00b894; 
      --color-error: #e17055; 
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
      font-family: 'Segoe UI', sans-serif; 
      background: linear-gradient(135deg, var(--color-bg-start), var(--color-bg-end)); 
      min-height: 100vh; 
      padding: 20px; 
      color: white;
    }
    
    .container { 
      max-width: 800px; 
      margin: auto; 
      background: rgba(255,255,255,0.1); 
      border-radius: 20px; 
      padding: 30px;
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      text-align: center;
    }
    
    h1 { 
      font-size: 2.5em; 
      margin-bottom: 20px; 
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }
    
    .mode-selector {
      margin: 30px 0;
    }
    
    .mode-btn {
      display: inline-block;
      margin: 10px;
      padding: 20px 30px;
      background: linear-gradient(135deg, var(--color-primary), #0984e3);
      color: white;
      border: none;
      border-radius: 15px;
      font-size: 1.2em;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.3s;
      text-decoration: none;
      min-width: 200px;
    }
    
    .mode-btn:hover { 
      transform: translateY(-5px); 
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    }
    
    .game-area {
      background: rgba(255,255,255,0.2);
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
      min-height: 400px;
      display: none;
    }
    
    .question-card {
      background: rgba(255,255,255,0.9);
      color: #333;
      border-radius: 15px;
      padding: 25px;
      margin: 15px 0;
      text-align: left;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .question-title {
      font-size: 1.3em;
      font-weight: bold;
      margin-bottom: 20px;
      color: #2c3e50;
    }
    
    .choice {
      display: block;
      margin: 12px 0;
      padding: 15px;
      background: #f8f9fa;
      border: 2px solid transparent;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .choice:hover {
      background: #e3f2fd;
      border-color: var(--color-primary);
      transform: translateX(5px);
    }
    
    .choice.selected {
      background: #bbdefb;
      border-color: var(--color-primary);
    }
    
    .choice.correct {
      background: #c8e6c9 !important;
      border-color: var(--color-success) !important;
      color: #2e7d32;
    }
    
    .choice.incorrect {
      background: #ffcdd2 !important;
      border-color: var(--color-error) !important;
      color: #c62828;
    }
    
    button {
      background: linear-gradient(135deg, var(--color-primary), #0984e3);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      margin: 10px;
      transition: transform 0.2s;
    }
    
    button:hover { transform: translateY(-3px); }
    button:disabled { 
      background: #999; 
      cursor: not-allowed; 
      transform: none; 
    }
    
    .score-display {
      font-size: 1.3em;
      margin: 20px 0;
      padding: 15px;
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
    }
    
    .progress-bar {
      background: rgba(255,255,255,0.3);
      border-radius: 10px;
      height: 8px;
      margin: 15px 0;
      overflow: hidden;
    }
    
    .progress-fill {
      background: linear-gradient(90deg, #00d2ff, #3a7bd5);
      height: 100%;
      width: 0%;
      transition: width 0.5s ease;
      border-radius: 10px;
    }
    
    .final-results {
      background: linear-gradient(135deg, #ff9a9e, #fad0c4);
      color: #333;
      border-radius: 15px;
      padding: 30px;
      margin: 20px 0;
    }
    
    .intro-text {
      font-size: 1.1em;
      line-height: 1.6;
      margin: 20px 0;
      opacity: 0.9;
    }
    
    .feature-list {
      text-align: left;
      display: inline-block;
      margin: 20px 0;
    }
    
    .feature-list li {
      margin: 8px 0;
      padding-left: 10px;
    }
    
    .timer {
      font-size: 1.5em;
      font-weight: bold;
      color: #FFD700;
      margin: 10px 0;
    }
    
    .connection-info {
      background: rgba(255,255,255,0.15);
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      font-size: 0.9em;
    }
    
    .qr-code {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin: 20px auto;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéØ Quiz DWWM Interactif</h1>
    
    <!-- Menu principal -->
    <div id="mainMenu">
      <div class="intro-text">
        <strong>üöÄ Quiz professionnel pour la formation DWWM</strong><br>
        Testez vos connaissances en d√©veloppement web !
      </div>
      
      <div class="feature-list">
        <ul>
          <li>‚úÖ <strong>Mode Solo</strong> - Entra√Ænement personnel</li>
          <li>üéÆ <strong>Mode Multijoueur</strong> - PC h√¥te + mobiles joueurs</li>
          <li>‚ö° <strong>Questions m√©lang√©es</strong> - Jamais le m√™me quiz</li>
          <li>üèÜ <strong>Scores et classements</strong> - Comp√©tition amicale</li>
          <li>üì± <strong>Mobile-friendly</strong> - Fonctionne partout</li>
        </ul>
      </div>
      
      <div class="mode-selector">
        <button class="mode-btn" onclick="startSoloMode()">
          ‚ö° Mode Solo<br>
          <small>Test rapide individuel</small>
        </button>
        
        <button class="mode-btn" onclick="startHostMode()">
          üñ•Ô∏è Mode H√¥te<br>
          <small>Cr√©er une partie multijoueur</small>
        </button>
        
        <button class="mode-btn" onclick="startPlayerMode()">
          üì± Rejoindre<br>
          <small>Participer √† une partie</small>
        </button>
      </div>
    </div>
    
    <!-- Zone de jeu -->
    <div class="game-area" id="gameArea">
      <div class="score-display" id="scoreDisplay"></div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <div class="timer" id="timer"></div>
      <div id="questionContainer"></div>
    </div>
    
    <!-- Section multijoueur -->
    <div class="connection-info" id="connectionInfo" style="display:none;">
      <div id="roomCode"></div>
      <div class="qr-code" id="qrCode" style="display:none;"></div>
      <div id="playersList"></div>
    </div>
  </div>

  <script>
    // Questions DWWM - Ajoutez vos vraies questions ici
    const questionsBySubject = [
      {
        title: "Quel langage est principalement utilis√© pour le d√©veloppement web c√¥t√© client ?",
        choices: ["PHP", "JavaScript", "Python", "Java"],
        answer: [1]
      },
      {
        title: "Quels sont les piliers du d√©veloppement web moderne ?",
        choices: ["HTML", "CSS", "JavaScript", "Flash"],
        answer: [0, 1, 2]
      },
      {
        title: "Que signifie CSS ?",
        choices: ["Computer Style Sheets", "Cascading Style Sheets", "Creative Style Sheets", "Colorful Style Sheets"],
        answer: [1]
      },
      {
        title: "Quels frameworks JavaScript sont populaires ?",
        choices: ["React", "Vue.js", "Angular", "jQuery"],
        answer: [0, 1, 2]
      },
      {
        title: "Quel protocole est utilis√© pour les communications web s√©curis√©es ?",
        choices: ["HTTP", "HTTPS", "FTP", "SSH"],
        answer: [1]
      },
      {
        title: "Que signifie HTML ?",
        choices: ["Hypertext Markup Language", "High Tech Modern Language", "Home Tool Markup Language", "Hypertext Machine Language"],
        answer: [0]
      },
      {
        title: "Quels sont les types de donn√©es primitifs en JavaScript ?",
        choices: ["string", "number", "boolean", "object"],
        answer: [0, 1, 2]
      },
      {
        title: "Quel est le r√¥le principal d'un d√©veloppeur web ?",
        choices: ["Cr√©er des sites web", "R√©parer des ordinateurs", "Installer des logiciels", "G√©rer des r√©seaux"],
        answer: [0]
      },
      {
        title: "Quels outils sont essentiels pour un d√©veloppeur web ?",
        choices: ["√âditeur de code", "Navigateur", "Serveur local", "Calculatrice"],
        answer: [0, 1, 2]
      },
      {
        title: "Que permet de faire PHP ?",
        choices: ["D√©veloppement c√¥t√© serveur", "Stylisation des pages", "Animation des √©l√©ments", "Gestion de base de donn√©es"],
        answer: [0, 3]
      }
    ];

    // Variables globales
    let currentMode = '';
    let currentQuestionIndex = 0;
    let score = 0;
    let questions = [];
    let selectedChoices = [];
    let hasAnswered = false;
    let timeLeft = 30;
    let timer = null;
    
    // √âl√©ments DOM
    const mainMenu = document.getElementById('mainMenu');
    const gameArea = document.getElementById('gameArea');
    const questionContainer = document.getElementById('questionContainer');
    const scoreDisplay = document.getElementById('scoreDisplay');
    const progressFill = document.getElementById('progressFill');
    const timerDisplay = document.getElementById('timer');
    const connectionInfo = document.getElementById('connectionInfo');

    // Mode Solo
    function startSoloMode() {
      currentMode = 'solo';
      mainMenu.style.display = 'none';
      gameArea.style.display = 'block';
      
      // Initialiser le quiz
      questions = shuffleArray([...questionsBySubject]).slice(0, 5);
      currentQuestionIndex = 0;
      score = 0;
      
      showQuestion();
    }

    // Mode H√¥te
    function startHostMode() {
      currentMode = 'host';
      mainMenu.style.display = 'none';
      gameArea.style.display = 'block';
      connectionInfo.style.display = 'block';
      
      // G√©n√©rer code de partie
      const roomCode = Math.random().toString(36).substring(2, 8).toUpperCase();
      
      document.getElementById('roomCode').innerHTML = `
        <h3>üè† Vous √™tes l'h√¥te</h3>
        <div style="font-size: 1.5em; margin: 15px 0; color: #FFD700;">
          Code de partie: <strong>${roomCode}</strong>
        </div>
        <p>Partagez ce code avec les joueurs !</p>
        <div style="margin: 20px 0;">
          <button onclick="startQuizAsHost()" style="font-size: 1.2em; padding: 15px 30px; background: #28a745;">
            üöÄ D√©marrer le Quiz
          </button>
        </div>
      `;
      
      // G√©n√©rer QR Code simple (texte)
      const url = `${window.location.origin}${window.location.pathname}?join=${roomCode}`;
      document.getElementById('qrCode').innerHTML = `
        <div style="color: #333; padding: 10px;">
          <strong>URL √† partager :</strong><br>
          <small>${url}</small><br>
          <em>(Scannez ce texte ou partagez l'URL)</em>
        </div>
      `;
      document.getElementById('qrCode').style.display = 'block';
      
      // Afficher l'interface d'attente
      questionContainer.innerHTML = `
        <div style="text-align: center; font-size: 1.3em; padding: 40px;">
          üë• <strong>En attente des joueurs...</strong><br><br>
          <div style="margin: 20px 0;">
            Les joueurs peuvent rejoindre avec le code: <strong style="color: #FFD700;">${roomCode}</strong>
          </div>
          <div style="font-size: 0.9em; opacity: 0.8;">
            üí° Cliquez sur "D√©marrer le Quiz" quand tout le monde est pr√™t !
          </div>
        </div>
      `;
      
      // Initialiser le quiz (mais ne pas le d√©marrer)
      questions = shuffleArray([...questionsBySubject]).slice(0, 5);
      currentQuestionIndex = 0;
      score = 0;
    }

    // D√©marrer le quiz (appel√© par l'h√¥te)
    function startQuizAsHost() {
      // R√©cup√©rer le code de la partie depuis l'affichage
      const roomCodeElement = document.querySelector('#roomCode strong');
      const roomCode = roomCodeElement ? roomCodeElement.textContent : 'XXXX';
      
      // Cacher le bouton de d√©marrage
      document.getElementById('roomCode').innerHTML = `
        <h3>üè† Quiz en cours</h3>
        <div>Partie: <strong>${roomCode}</strong></div>
        <p>üéØ Vous contr√¥lez le quiz</p>
      `;
      
      // D√©marrer le quiz
      showQuestion();
    }

    // Mode Joueur
    function startPlayerMode() {
      const roomCode = prompt('Entrez le code de la partie :');
      if (!roomCode) return;
      
      currentMode = 'player';
      mainMenu.style.display = 'none';
      gameArea.style.display = 'block';
      connectionInfo.style.display = 'block';
      
      document.getElementById('roomCode').innerHTML = `
        <h3>üì± Joueur connect√©</h3>
        <div>Partie: <strong>${roomCode}</strong></div>
        <p>‚úÖ Connexion r√©ussie !</p>
      `;
      
      // Interface d'attente
      questionContainer.innerHTML = `
        <div style="text-align: center; font-size: 1.3em; padding: 40px;">
          ‚è≥ <strong>En attente de l'h√¥te...</strong><br><br>
          <div style="margin: 20px 0;">
            L'h√¥te va d√©marrer le quiz quand tout le monde sera pr√™t
          </div>
          <div style="font-size: 0.9em; opacity: 0.8;">
            üí° Restez sur cette page, le quiz commencera automatiquement !
          </div>
        </div>
      `;
      
      // Simuler attente puis d√©marrage (en vrai √ßa viendrait du serveur)
      setTimeout(() => {
        document.getElementById('roomCode').innerHTML = `
          <h3>üì± Quiz d√©marr√©</h3>
          <div>Partie: <strong>${roomCode}</strong></div>
          <p>üéØ R√©pondez aux questions !</p>
        `;
        
        questions = shuffleArray([...questionsBySubject]).slice(0, 5);
        currentQuestionIndex = 0;
        score = 0;
        showQuestion();
      }, 3000);
    }

    // Afficher une question
    function showQuestion() {
      if (currentQuestionIndex >= questions.length) {
        showFinalResults();
        return;
      }
      
      const question = questions[currentQuestionIndex];
      hasAnswered = false;
      selectedChoices = [];
      
      let html = '';
      
      // Interface diff√©rente selon le mode
      if (currentMode === 'host') {
        // Vue h√¥te - contr√¥le le quiz
        html = `
          <div class="question-card">
            <div class="question-title">
              üëë Question ${currentQuestionIndex + 1}/${questions.length}: ${question.title}
            </div>
            <div style="margin: 20px 0; padding: 15px; background: rgba(0,200,0,0.1); border-radius: 10px;">
              <strong>‚úÖ R√©ponses correctes :</strong><br>
        `;
        
        question.choices.forEach((choice, i) => {
          const isCorrect = question.answer.includes(i);
          html += `
            <div style="margin: 8px 0; padding: 10px; background: ${isCorrect ? '#c8e6c9' : '#f5f5f5'}; border-radius: 5px;">
              ${isCorrect ? '‚úÖ' : '‚óØ'} ${choice}
            </div>
          `;
        });
        
        html += `
            </div>
            <div style="text-align: center; margin: 20px 0;">
              <button onclick="nextQuestionAsHost()" style="font-size: 1.2em; padding: 15px 30px; background: #17a2b8; margin: 5px;">
                ‚û°Ô∏è Question suivante
              </button>
              <button onclick="endQuizAsHost()" style="font-size: 1.2em; padding: 15px 30px; background: #dc3545; margin: 5px;">
                üèÅ Terminer le quiz
              </button>
            </div>
            <div style="font-size: 0.9em; opacity: 0.7; text-align: center;">
              üí° Les joueurs voient cette question et peuvent r√©pondre
            </div>
          </div>
        `;
        
      } else {
        // Vue joueur/solo - peut r√©pondre
        
        // D√©marrer le timer seulement pour les joueurs
        timeLeft = 30;
        startTimer();
        
        html = `
          <div class="question-card">
            <div class="question-title">
              Question ${currentQuestionIndex + 1}/${questions.length}: ${question.title}
            </div>
            <div class="choices">
        `;
        
        question.choices.forEach((choice, i) => {
          html += `
            <div class="choice" onclick="selectChoice(${i})" data-choice="${i}">
              ${choice}
            </div>
          `;
        });
        
        html += `
            </div>
            <button onclick="submitAnswer()" id="submitBtn">üìù Valider ma r√©ponse</button>
          </div>
        `;
      }
      
      questionContainer.innerHTML = html;
      updateScore();
      updateProgress();
    }

    // Question suivante (contr√¥l√©e par l'h√¥te)
    function nextQuestionAsHost() {
      currentQuestionIndex++;
      showQuestion();
    }

    // Terminer le quiz manuellement (h√¥te)
    function endQuizAsHost() {
      if (confirm('√ätes-vous s√ªr de vouloir terminer le quiz maintenant ?')) {
        currentQuestionIndex = questions.length; // Force la fin
        showFinalResults();
      }
    }

    // S√©lectionner une r√©ponse
    function selectChoice(choiceIndex) {
      if (hasAnswered) return;
      
      const choice = document.querySelector(`[data-choice="${choiceIndex}"]`);
      
      if (choice.classList.contains('selected')) {
        choice.classList.remove('selected');
        selectedChoices = selectedChoices.filter(i => i !== choiceIndex);
      } else {
        choice.classList.add('selected');
        selectedChoices.push(choiceIndex);
      }
    }

    // Soumettre la r√©ponse
    function submitAnswer() {
      if (hasAnswered || selectedChoices.length === 0) {
        if (selectedChoices.length === 0) {
          alert('Veuillez s√©lectionner au moins une r√©ponse !');
        }
        return;
      }
      
      hasAnswered = true;
      const currentQuestion = questions[currentQuestionIndex];
      
      // Arr√™ter le timer
      clearInterval(timer);
      
      // V√©rifier la r√©ponse
      const isCorrect = JSON.stringify(selectedChoices.sort()) === JSON.stringify(currentQuestion.answer.sort());
      if (isCorrect) score++;
      
      // Afficher le feedback
      document.querySelectorAll('.choice').forEach((choice, i) => {
        const isCorrectAnswer = currentQuestion.answer.includes(i);
        const isSelected = selectedChoices.includes(i);
        
        choice.style.pointerEvents = 'none';
        
        if (isCorrectAnswer) {
          choice.classList.add('correct');
        } else if (isSelected) {
          choice.classList.add('incorrect');
        }
      });
      
      // D√©sactiver le bouton
      document.getElementById('submitBtn').disabled = true;
      document.getElementById('submitBtn').textContent = isCorrect ? '‚úÖ Correct !' : '‚ùå Incorrect';
      
      // En mode solo, passer automatiquement √† la question suivante
      if (currentMode === 'solo') {
        setTimeout(() => {
          currentQuestionIndex++;
          showQuestion();
        }, 3000);
      } else {
        // En mode multijoueur, attendre que l'h√¥te passe √† la question suivante
        document.getElementById('submitBtn').textContent += ' - En attente de la question suivante...';
      }
    }

    // Timer
    function startTimer() {
      // Le timer n'est affich√© que pour les joueurs, pas pour l'h√¥te
      if (currentMode === 'host') {
        timerDisplay.textContent = '';
        return;
      }
      
      timer = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = `‚è±Ô∏è ${timeLeft}s`;
        
        if (timeLeft <= 0) {
          clearInterval(timer);
          if (!hasAnswered) {
            submitAnswer(); // Auto-submit
          }
        }
      }, 1000);
    }

    // Mise √† jour du score
    function updateScore() {
      if (currentMode === 'host') {
        scoreDisplay.textContent = `üëë H√¥te - Question ${currentQuestionIndex + 1}/${questions.length}`;
      } else {
        scoreDisplay.textContent = `Score: ${score}/${currentQuestionIndex} | Question ${currentQuestionIndex + 1}/${questions.length}`;
      }
    }

    // Mise √† jour de la progression
    function updateProgress() {
      const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
      progressFill.style.width = progress + '%';
    }

    // R√©sultats finaux
    function showFinalResults() {
      clearInterval(timer);
      timerDisplay.textContent = '';
      
      let html = '';
      
      if (currentMode === 'host') {
        // Vue h√¥te - r√©sultats globaux
        html = `
          <div class="final-results">
            <h2>üèÜ Quiz termin√© !</h2>
            <div style="font-size: 1.5em; margin: 20px 0;">
              üëë Vous avez anim√© le quiz avec succ√®s !
            </div>
            <div style="font-size: 1.2em; margin: 15px 0;">
              ${questions.length} questions pr√©sent√©es
            </div>
            <div style="margin: 20px 0;">
              üí° Les joueurs voient leurs scores individuels
            </div>
            <button onclick="restart()" style="font-size: 1.2em; padding: 15px 30px;">
              üîÑ Nouveau quiz
            </button>
            <button onclick="goHome()" style="font-size: 1.2em; padding: 15px 30px; background: #6c757d;">
              üè† Menu principal
            </button>
          </div>
        `;
      } else {
        // Vue joueur/solo - score personnel
        const percentage = Math.round((score / questions.length) * 100);
        
        let performance = '';
        if (percentage >= 80) performance = 'üèÜ Excellent !';
        else if (percentage >= 60) performance = 'üëè Bien jou√© !';
        else if (percentage >= 40) performance = 'üìö √Ä retravailler';
        else performance = 'üí™ Continuez vos efforts !';
        
        html = `
          <div class="final-results">
            <h2>üéØ Quiz termin√© !</h2>
            <div style="font-size: 2em; margin: 20px 0;">
              ${score}/${questions.length}
            </div>
            <div style="font-size: 1.5em; margin: 15px 0;">
              ${percentage}% de r√©ussite
            </div>
            <div style="font-size: 1.3em; margin: 15px 0;">
              ${performance}
            </div>
            <button onclick="restart()" style="font-size: 1.2em; padding: 15px 30px;">
              üîÑ Refaire un quiz
            </button>
            <button onclick="goHome()" style="font-size: 1.2em; padding: 15px 30px; background: #6c757d;">
              üè† Menu principal
            </button>
          </div>
        `;
      }
      
      questionContainer.innerHTML = html;
    }

    // Red√©marrer
    function restart() {
      if (currentMode === 'solo') {
        startSoloMode();
      } else if (currentMode === 'host') {
        startHostMode();
      } else {
        startPlayerMode();
      }
    }

    // Retour au menu
    function goHome() {
      gameArea.style.display = 'none';
      connectionInfo.style.display = 'none';
      mainMenu.style.display = 'block';
      clearInterval(timer);
    }

    // M√©langer un tableau
    function shuffleArray(array) {
      const arr = [...array];
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    // Auto-join via URL
    window.addEventListener('load', () => {
      const urlParams = new URLSearchParams(window.location.search);
      const joinCode = urlParams.get('join');
      if (joinCode) {
        setTimeout(() => startPlayerMode(), 500);
      }
    });
  </script>
</body>
</html>
